<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.0/dist/JsBarcode.all.min.js"></script>
  <link rel="stylesheet" href="css/style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tiro+Bangla:ital@0;1&display=swap" rel="stylesheet">
</head>

<body class="flex justify-between max-w-screen-lg mx-auto tiro-bangla-regular" x-data="pageState()">
  <div class="bg-slate-200 w-52 p-2 flex flex-col space-y-2">
    <div>
      <label for="">দোকানের নাম</label>
      <input x-model="name" type="text" placeholder="Your Store Name" class="focus:outline-none bg-white text-slate-900 w-full px-1">
    </div>
    <div>
      <label for="">পণ্যের নাম</label>
      <input x-model="product" type="text" placeholder="Product Name" class="focus:outline-none bg-white text-slate-900 w-full px-1">
    </div>
    <div>
      <label for="">পণ্যের মূল্য</label>
      <input x-model="price" type="number" placeholder="Product Name" class="focus:outline-none bg-white text-slate-900 w-full px-1" :min="0">
    </div>
    <div class="flex space-x-2">
      <div>
        <label for="">ওজন</label>
        <input x-model.number="weight" type="number" placeholder="Product Weight" class="focus:outline-none bg-white text-slate-900 w-full px-1" :min="0">
      </div>
      <div>
        <label for="">ওজন একক</label>
        <input x-model="weightType" type="text" placeholder="Weight Type" class="focus:outline-none bg-white text-slate-900 w-full px-1">
      </div>
    </div>
    <div>
      <label for="">উৎপাদন তারিখ</label>
      <input x-model="manufacture" type="date" placeholder="Product Manufacture" class="focus:outline-none bg-white text-slate-900 w-full px-1">
    </div>

    <div>
      <label for="">মেয়াদ তারিখ</label>
      <input x-model="expired" type="date" placeholder="Product Expired" class="focus:outline-none bg-white text-slate-900 w-full px-1">
    </div>
    <div>
      <label for="">কত পিস প্রিন্ট?</label>
      <input x-model.number="pice" type="number" placeholder="Product Expired" class="focus:outline-none bg-white text-slate-900 w-full px-1" @input="createBarcode()">
    </div>
    <div>
      <label for="">পণ্য বারকোড</label>
      <input x-model="sku" type="number" placeholder="Product Expired" class="focus:outline-none bg-white text-slate-900 w-full px-1">
    </div>
    <div class="pt-5 flex flex-col space-y-3">
      <button type="button" class="w-full bg-black text-white rounded py-2" @click="createBarcode">বারকোড তৈরী করুন</button>
      <button type="button" class="w-full bg-black text-white rounded py-2" @click="printBarcode">প্রিন্ট করুন</button>
    </div>
  </div>
  <div class="w-[200mm] min-h-dvh p-1 border-slate-800 border-dashed border" id="bigInvoice">
    <div x-show="action" class="grid grid-cols-5 gap-1 text-xs pt-1">
      <template x-for="n in pice" :key="n">
        <fieldset class="border border-solid border-slate-900 text-center rounded flex flex-col items-center justify-center p-1">
          <legend x-text="name" class="font-bold"></legend>
          <div class="flex justify-evenly space-x-[4px]">
            <div class="flex space-x-[2px]">
              <span x-text="product" class="font-bold"></span>
              <div class="flex space-x-[2px]">
                <span x-text="engToBanglaDigit(weight)" class="font-bold">0</span>
                <span x-text="weightType">gm</span>
              </div>
            </div>
            <div class="font-bold flex space-x-[2px]">
              <span>মূল্য:</span>
              <span x-text="engToBanglaDigit(price)"></span>
              <span>টাকা</span>
            </div>
          </div>
          <div class="flex space-x-1" x-show="manufacture">
            <span class="font-bold">উৎ.</span>
            <span x-text="new Date(manufacture).toLocaleDateString('bn-EG')"></span>
          </div>
          <div class="flex space-x-1" x-show="expired">
            <span class="font-bold">মেয়া.</span>
            <span x-text=" new Date(expired).toLocaleDateString('bn-EG')">gm</span>
          </div>
          <svg :id="'barcode-' + n" class="w-full h-fit px-3"></svg>
        </fieldset>
      </template>
    </div>
  </div>
</body>

<script>
  function pageState() {
    return {
      action: false,
      name: 'সপ্ন বাজার',
      product: "চিনি",
      price: 0,
      weight: 25,
      weightType: 'গ্রাম',
      manufacture: '',
      expired: '',
      pice: 45,
      sku: '000398',
      createBarcode() {
        Alpine.nextTick(() => {
          this.action = true;
          for (let i = 1; i <= this.pice; i++) {
            JsBarcode("#barcode-" + i, this.sku, {
              format: "CODE128",
              lineColor: "#000",
              width: 2,
              height: 25,
              displayValue: true,
              fontSize: 14,
              font: "monospace",
              text: this.sku,
              margin: 0,
              flat: false,
            });
          }
        })
      },
      printBarcode() {
        Alpine.nextTick(() => {
          if (this.action) {
            window.print();
          }
        });
      },
      engToBanglaDigit(engNumber) {
        // English to Bangla digit mapping
        const engToBn = {
          '0': '০',
          '1': '১',
          '2': '২',
          '3': '৩',
          '4': '৪',
          '5': '৫',
          '6': '৬',
          '7': '৭',
          '8': '৮',
          '9': '৯'
        };

        // Convert each digit using the mapping
        return String(engNumber).split('').map(char => engToBn[char] || char).join('');
      }
    }
  }
</script>

</html>